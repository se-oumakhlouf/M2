# TP 01

</br>

- ## Word Count

    - 1.2 :
        ```scala
        val whale = sc.textFile("mobyDick.txt")

        whale.count() // 21932
        ```

    - 1.3 :
        ```scala
        val chapters = whale.filter(line => line.contains("CHAPTER"))

        chapters.count() // res0: Long = 285
        ```

    - 1.4 :
        ```scala
        al nonEmpty = whale.filter(line => line.isEmpty() == false) // res1: Long = 18913
        ```

    - 1.5 :
        ```scala
        val wordCounter = nonEmpty.flatMap(line => line.split("\\W+")).map(_.toLowerCase).map(word => (word, 1)).reduceByKey(_ + _)
        ```

    - 1.6 :
        ```scala
        val captainCount = wordCounter.filter { case (word, count) => word == "captain" }.map { case (word, count) => count }.sum()
        ```

</br>

- ## Triangle processing

    - 2.0 :
        ```scala
        val triangles = sc.parallelize(List(
            List(('x',2,'y'),('x',3,'z'),('y',2,'z')),
            List(('x',1,'y'),('x',3,'z'),('y',2,'z')),
            List(('x',1,'y'),('y',1,'z'),('z',1,'x')),
            List(('x',1,'y'),('y',2,'z'),('z',1,'x')),
            List(('x',1,'y'),('y',3,'z'),('z',2,'x'))
            ))
        ```

    - 2.1 :
        ```scala
        val discovery = triangles.map(triangle => triangle.map(edge => (edge._1, edge._3)))
        ```

    - 2.2 :
        ```scala
        val cyclic = triangles.filter(triangle => triangle.map(x => x._1).toSet.size == 3)

        val acyclic = triangles.subtract(cyclic)
        ```

    - 2.3.1 :
        ```scala
        val triples = triangles.filter(triangle => triangle.map(x => x._2).toSet.size == 1).map(triangle => triangle.flatMap(x => List(x._1, x._3)).distinct)
        ```

    - 2.3.2 :
        ```scala

        ```




        