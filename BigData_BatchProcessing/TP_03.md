# TP 03

</br>

- ## Bikes

    - 1 :
        ```scala
        val bikeStations = spark.read.option("header", "true").option("inferSchema", "true").csv("stationData.csv")

        val tripData = spark.read.option("header", "true").option("inferSchema", "true").csv("tripData.csv")
        ```

    - 2 :
        ```scala
        bikeStations.printSchema()
        bikeStations.show(5)

        tripData.printSchema()
        tripData.show(5)
        ```

    - 3 :
        ```scala
        bikeStations.createOrReplaceTempView("bikeStations")
        tripData.createOrReplaceTempView("tripData")
        ```

    - 4 :
        ```scala
        spark.sql("SELECT count(TripID) FROM tripData").show()
        tripData.count()
        ```

    - 5 :
        ```scala
        spark.sql("SELECT * from tripData where StartStation == EndStation").show()
        ```

    - 6 :
        ```scala
        spark.sql("""
            SELECT StartStation as terminal, COUNT(*) as count
            FROM tripData 
            WHERE StartStation = EndStation
            GROUP BY StartStation
            ORDER BY count DESC
            """).show()
        ```